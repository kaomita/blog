---
title: Configuer Ubuntu20.04 Server
icon: gear
# sidebar: false
date: 2024-09-30
category:
  - ubuntu
tag:
  - config
---

## Network
Since this is a server, it's best to set a static IP, so the IP address won't change every time the system restarts.

Before configuring a static IP, you might want to give your network interface a memorable name. This can be a bit tricky since the server needs to recognize the new name after each reboot, but it’s worth the effort.
```bash
# open the configuration file
sudo nano /etc/udev/rules.d/70-persistent-net.rules

# add the following, adjusting for your neywork card's address
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="08:00:27:53:8b:dc", NAME="eth0"

# save and restart the network service
sudo update-initramfs -u

# reboot the system
sudo reboot
```

---

Next, you can configure the static IP:

```bash
ip a    # check the network interface name
sudo nano /etc/netplan/00-installer-config-wifi.yaml   # edit the network configuration file
```
In the file you open, it should already contain the name of your network interface. You can modify this name and set dhcp to static, then add your IP, gateway, DNS, and other settings like this:
```yaml
# This is the network config written by 'subiquity'
network:
  version: 2
  wifis:
    eth0:   # interface name
      access-points:
        '340':  # wifi name
          password: 123qweasd   # wifi password
      dhcp4: no
      dhcp6: no
      addresses: [192.168.1.100/24] # IP: 192.168.1.100, Subnet mask: 24
      gateway4: 192.168.1.1     # gateway
      nameservers:
        addresses: [8.8.8.8, 114.114.114.114] # DNS
```
Set the IP and gateway according to your router. For instance, if your router’s IPv4 is `10.162.6.x`, then your IP should be `10.162.6.x` (Change `x` to any number you want between 2-255), and the gateway will be `10.162.6.1`.

After that, press `Ctrl+S` to save and `Ctrl+X` to exit, then run:
```bash
sudo netplan apply  # apply the network configuration
ip a    # check if the IP is effective
```

## vim
Ubuntu comes with a basic version of Vim. You can further configure it according to your preferences, or download someone else’s configuration file. If you're not a heavy Vim user, the default setup with minor tweaks should suffice.
```bash
1 set tabstop=4              " Set Tab to 4 spaces
2 colorscheme desert         " Set the color scheme to 'desert'
3 syntax on       " Enable syntax highlighting
4 set number      " Show line numbers
5 set noeb        " Disable error beeping or screen flashing
6 set vb t_vb=    " Mute Vim sounds

```

## Shell
### Installing zsh
Ubuntu’s default shell is quite bare, and its tab completion can not select a file after suggestions. I recommend installing Zsh along with Oh My Zsh to enhance your shell experience.

```bash
sudo apt update
sudo apt install zsh

# Set Zsh as the default shell
chsh -s $(which zsh)

# Install Oh My Zsh
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
```

Afterward, all terminal settings will be in the `~/.zshrc` file, instead of `~/.bashrc`.

### Installing Plugins
You can follow [this guide](https://www.hackerneo.com/blog/dev-tools/better-use-terminal-with-zsh) to install useful plugins for Zsh.


## Proxy
### Download Clash Verge
[Link](https://github.com/zzzgydi/clash-verge/releases). If you're using a graphical interface, download the `.AppImage.tar.gz` version. If you're on a server, download the `.deb` version.

### Installing clash verge

::: code-tabs#shell

@tab Server

```bash
sudo dpkg -i clash-verge_X.X.X_amd64.deb  # Install

# If you encounter dependency errors, run this to fix them
sudo apt-get install -f
```

@tab GUI

```bash
tar -xzf clash-verge-X.X.X.AppImage.tar.gz  # unzip
chmod +x clash-verge-X.X.X.AppImage # Add execution permissions
./clash-verge-X.X.X.AppImage
```
:::

### Configuring Clash
You’ll need a Clash configuration file (typically `config.yaml`), which you can get from your proxy provider.

```bash
mkdir -p ~/.config/clash
cp /path/to/your/config.yaml ~/.config/clash/config.yaml
```

Additionally, for Clash to function properly, you'll need to download the Country.mmdb database file, a GeoIP database that maps IP addresses to geographical locations. You can download it [here](https://files.ip.plus/Country.mmdb) and place it in the `~/.config/clash/` directory.

```bash
cp Country.mmdb ~/.config/clash/
```

Now you can start the proxy using the `clash` command. If you run into port issues, try running `sudo clash`.

### Using Procychains
Proxychains allows you to specify which applications should use the proxy. For example:

```bash
sudo clash  # start clash
proxychains git push # Use the proxy for git push
git push # No proxy for git push
```

To install and configure Proxychains:

```bash
sudo apt update
sudo apt install proxychains

# Edit the configuration file
sudo vim /etc/proxychains.conf

# Enable automatic proxy detection
dynamic_chain

# Add your proxy, adjusting the IP and port to your setup
http  127.0.0.1  8080
socks5  127.0.0.1  1080
```

## Zerotier for NAT Traversal
```bash
sudo apt install zerotier-one

# start zerotier
sudo systemctl start zerotier-one

# Join a network
sudo zerotier-cli join NETWORK_ID

# Check network status
sudo zerotier-cli info
```

## Disable Terminal Beep
```bash
sudo nano /etc/inputrc

# 添加如下内容
sudo nano /etc/inputrc
# Add the following
set bell-style none

# Disable Zsh beep
echo "setopt BEEP" >> ~/.zshrc

# Disable Vim beep
echo "set vb t_vb=" >> ~/.vimrc

# Restart the terminal
```

