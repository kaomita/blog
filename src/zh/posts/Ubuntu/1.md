---
title: 安装 Ubuntu 20.04 服务器
icon: server
# sidebar: false
date: 2024-09-29
category:
  - ubuntu
tag:
  - 教程
---

前言:用作服务器的是一台8年前的海尔笔记本电脑，双核1.1GHz，4G RAM，1T ROM，已经不能从容地使用windows图形化界面了。在这之前被我安装了Manjaro和windows10双系统，但实验课需要使用Ubuntu，于是再安装一个Ubuntu做三系统。但中间出现很多小插曲，比如Manjaro在reboot后直接从硬盘蒸发了，装好ubuntu后win10的启动引导也没了，好在ubuntu server最后安稳落机。

Manjaro也使用了一段时间，和ubuntu比起来，我更喜欢manjaro管理和安装软件的方式，但用作服务器，ubuntu更稳定一些，不过也更考验记忆力。

## 下载 Ubuntu 20.04 server
[官网下载](https://ubuntu.com/download)

## 制作系统启动盘
可以用U盘做系统启动盘，也可以用硬盘，但要分出一部分硬盘（大约5G）并格式化为FAT32。因为电脑太老usb接口老化，所以我使用了硬盘做启动盘，在此介绍用硬盘做启动盘的方法。

在此之前，如果不是把一整块磁盘用来当ubuntu的系统盘，需要先进行磁盘分区，并记住用来做ubuntu系统盘的分区号，例如我的是`partition7`。可以在windows终端中查询：
```bash
diskpart  
list disk   #查磁盘列表
select disk 0  #选择磁盘
list partition   #查分区列表
```

准备工作和制作方法可以参照[无U盘安装win和ubuntu双系统](https://blog.csdn.net/HeyKith/article/details/127728921)，如果你想下载ubuntu服务器版，只需参照前半部分就好，因为启动安装程序后，只有命令行。

## 安装 Ubuntu 20.04 server
进入安装页面，语言、键盘、网络设置等都可以默认，重点是磁盘分区，记住给ubuntu的分区号，我的是`partition7`，选择手动分区，选择`partition7`，格式化为ext4，挂载点为`/`。点击确认后`boot`应该会自动挂载到`partition2`。之后一直按`done`，直到安装完成。

如果在分区时出现错误，如下
::: warning 报错提示
Block probing did not discover any disks. Unfortunately this means that installation will not be possible.
:::

那么恭喜抽到彩蛋。

按下`F2`进入安装环境后，在终端中运行 `lsblk` 或 `fdisk -l`，看看系统是否识别到硬盘。如果没有识别到，那么你的硬盘可能是`RAID`模式，需要在BIOS中关闭`RAID`模式，改为`AHCI`模式。至于进入BIOS的方法，大部分是开机时按`F2`或`F12`，具体可以按机型百度。

---

提示该报错还有一种情况，即使用光盘或 ISO 镜像，有时系统会尝试卸载挂载的光盘镜像导致卸载失败

![安装前提示的报错](./1-1.jpg)

这个问题困扰了我很久，最后在Stack Overflow找到了[解决方案](https://askubuntu.com/questions/1302392/ubuntu-server-20-04-setup-stuck-at-block-probing-did-not-discover-any-disks/1305972#1305972)。

进入安装页面后，不要按下done，按F2进入终端，输入`umount /cdrom -l`解除挂载，然后`ctrl+D`退出终端，从第一页开始安装，这时就可以正常分区了，**但是要注意**，如果是用硬盘做启动盘，最后安装时又会提示找不到启动盘，所以在进入分区页面后，再次进入终端，输入`sudo mount -o loop /dev/sda5 /cdrom`，将`sda5`替换为你的启动盘分区号，重新挂载启动盘，然后`ctrl+D`退出终端，再从分区页面开始安装，这时就可以正常安装了。

---

但很不幸的是，我在安装结束reboot后并没有预期地进入ubuntu终端，而是重复了安装过程，此时我以为安装失败，重复了上述过程，导致windows的启动引导丢失。真正的原因是ubuntu安装成功后，引导ubuntu的安装grub依旧排在第一行，所以默认开机进入ubuntu安装。解决办法是开机时进入BIOS，手动引导ubuntu启动。

至此，Ubuntu 20.04 server安装完成。

