---
title: 配置 Ubuntu 20.04 服务器
icon: gear
# sidebar: false
date: 2024-09-30
category:
  - ubuntu
tag:
  - 配置
---

## 网络
既然作为服务器，那么最好是静态ip，这样每次重启后ip也不会变。

配置静态ip前可以先给网卡起个好记得名字，为了让服务器重启后也认识网卡新名字，配置可能有点麻烦，但这样很有必要。
```bash
# 打开配置文件
sudo nano /etc/udev/rules.d/70-persistent-net.rules

# 添加如下内容，请根据自己的网卡地址修改
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="08:00:27:53:8b:dc", NAME="eth0"

# 保存后重启网络服务
sudo update-initramfs -u

# 重启系统
sudo reboot
```

---

之后你可以配置静态ip

```bash
ip a    #查看网卡名
sudo nano /etc/netplan/00-installer-config-wifi.yaml   #编辑网络配置文件
```
此时你打开的文件应该包含你的网卡名，你可以修改这个文件的网卡名，并将dhcp改为static，然后添加ip、gateway、dns等信息，像这样：
```yaml
# This is the network config written by 'subiquity'
network:
  version: 2
  wifis:
    eth0:   #网卡名
      access-points:
        '340':  #wifi名
          password: 123qweasd   #wifi密码
      dhcp4: no
      dhcp6: no
      addresses: [192.168.1.100/24] #ip为192.168.1.100，子网掩码为24
      gateway4: 192.168.1.1     #网关
      nameservers:
        addresses: [8.8.8.8, 114.114.114.114] #DNS
```
这里的ip和网关要根据路由器来设置，如果你的路由器提供的ipv4是`10.162.6.x`，那么你的ip应该设置为`10.162.6.x`（将x换为2-255之间你想要的任何数字），网关就是`10.162.6.1`

之后按`Ctrl+S`保存，`Ctrl+X`退出，然后执行
```bash
sudo netplan apply  #应用刚刚的网络配置
ip a    #查看ip是否生效
```

## vim
ubuntu默认有原生的vim，你可以在此基础上按自己的喜好进一步配置，也可以下载别人的配置文件。如果并不是高强度使用vim，可以默认用原装vim或只需要简单配置一下就好。
```bash
1 set tabstop=4              " 设置 Tab 为 4 个空格
2 colorscheme desert         " 设置配色方案为 desert
3 syntax on       " 启用语法高亮
4 set number      " 显示行号
5 set noeb        " 禁用错误提示音或屏幕闪烁
6 set vb t_vb=    " 禁用vim声音
```

## shell
### 安装zsh
ubuntu server的shell光秃秃的，而且tab给出文件建议后不能选择文件。这里推荐安装zsh，然后安装oh-my-zsh，来增强shell的功能。

```bash
sudo apt update
sudo apt install zsh

# 将zsh设置为默认shell
chsh -s $(which zsh)

# 安装 Oh My Zsh
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
```

之后对终端的设置都在`~/.zshrc`文件中，而不再是`~/.bashrc`。

### 安装插件
可以参照[这里](https://www.hackerneo.com/blog/dev-tools/better-use-terminal-with-zsh)


## 代理
### 下载clash verge
[地址](https://github.com/zzzgydi/clash-verge/releases)，如果你是图形化界面，可以选择`.AppImage.tar.gz`后缀的，如果是服务器，可以选择`.deb`后缀的。

### 安装clash verge

::: code-tabs#shell

@tab 服务器

```bash
sudo dpkg -i clash-verge_X.X.X_amd64.deb  # 安装

# 如果在安装过程中遇到依赖性错误，可以运行以下命令来修复
sudo apt-get install -f
```

@tab 图形化界面

```bash
tar -xzf clash-verge-X.X.X.AppImage.tar.gz  # 解压
chmod +x clash-verge-X.X.X.AppImage # 添加执行权限
./clash-verge-X.X.X.AppImage
```
:::

### 配置 Clash
你需要一个 Clash 配置文件（通常是 config.yaml），可以从你的代理服务提供商处获取。

```bash
mkdir -p ~/.config/clash
cp /path/to/your/config.yaml ~/.config/clash/config.yaml
```

此外，为了让 clash 能够正常工作，还需要下载 Country.mmdb 数据库文件。Country.mmdb 是一个 GeoIP 数据库文件，用于将 IP 地址映射到地理位置（国家/地区）。可以从这里[下载](https://files.ip.plus/Country.mmdb)，并将它放在 ~/.config/clash/ 目录下。

```bash
cp Country.mmdb ~/.config/clash/
```

现在可以通过`clash`命令来启动代理了，如果遇到不能启动的端口，可以尝试`sudo clash`。

### 使用 procychains
proxychains可以让你自己决定哪些程序走代理。例如

```bash
sudo clash  #启动clash
proxychains git push #git push走代理
git push #git push不走代理
```

下载并配置 proxychains

```bash
sudo apt update
sudo apt install proxychains

# 编辑配置文件
sudo vim /etc/proxychains.conf

# 打开自动检测代理
dynamic_chain

# 添加代理,根据自己的情况修改ip和端口
http  127.0.0.1  8080
socks5  127.0.0.1  1080
```

## 内网穿透工具zerotier
```bash
sudo apt install zerotier-one

# 启动zerotier
sudo systemctl start zerotier-one

# 加入网络
sudo zerotier-cli join NETWORK_ID

# 查看网络状态
sudo zerotier-cli info
```

## 关闭终端声音
```bash
sudo nano /etc/inputrc

# 添加如下内容
set bell-style none

# 返回终端，关闭zsh声音
echo "setopt BEEP" >> ~/.zshrc

# 关闭vim声音
echo "set vb t_vb=" >> ~/.vimrc

# 重启终端
```

